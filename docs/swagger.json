{
    "openapi": "3.0.0",
    "info": {
        "version": "1.0.0",
        "title": "Ecommerce JS",
        "description": "Ecommerce JS hecho con NodeJS version 20, mongoose, mongodb",
        "contact": {
            "name": "Ecommerce con Swagger API",
            "email": "johnmontoya777@hotmail.com",
            "url": "https://github.com/Johnmontoya"
        },
        "license": {
            "name": "Apache 2.0",
            "url": "https://www.apache.org/licenses/LICENSE-2.0.html"
        }
    },
    "servers": [
        {
            "url": "http://localhost:3000",
            "description": "Development Server"
        }
    ],
    "paths": {
        "/api/v1/categorias": {
            "get": {
                "summary": "Obtener todas las categorias",
                "description": "Retorna toda las categorias guardadas en la base de datos",
                "responses": {
                    "200": {
                        "description": "Lista todas las categorias",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Category"
                                    }
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "summary": "Crea una nueva categoria",
                "description": "Crea una categoria y la guarda en la base de datos",
                "operationId": "addCategory",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/NewCategory"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Category response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Category"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Name, icon, y color son campos requeridos"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/categorias/{id}": {
            "get": {
                "summary": "Obtiene una categoria por ID",
                "description": "Retorna una categoria por ID",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID de la categoria a buscar",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Recupera una categoria",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Category"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Category no encontrada"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "summary": "Actualiza una categoria por ID",
                "description": "Actualiza una categoria almacenada en la base de datos",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID de la categoria a buscar",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/NewCategory"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Category response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Category"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Name, icon, y color son campos requeridos"
                    },
                    "404": {
                        "description": "Category no encontrada o actualizada"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "summary": "Borrar una categoria por ID",
                "description": "Borra una categoria de la base de datos",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID de la categoria a buscar",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "La categoria ha sido borrada"
                    },
                    "404": {
                        "description": "Category no encontrada"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/products": {
            "get": {
                "summary": "Obtiene todos los productos",
                "description": "Retorna todos los productos de la base de datos",
                "parameters": [
                    {
                        "name": "categories",
                        "in": "query",
                        "description": "Filtrar por categoria",
                        "required": false,
                        "style": "form",
                        "schema": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        }
                    },{
                        "name": "limit",
                        "in": "query",
                        "description": "Número de elementos a retornar",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "format": "int32"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lista todos los productos",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Product"
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Producto no encontrado"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "summary": "Crea un nuevo producto",
                "description": "Crea un nuevo producto y la guarda en la base de datos",
                "operationId": "addProduct",
                "requestBody": {
                    "required": true,
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "$ref": "#/components/schemas/NewProduct"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Product response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Product"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "El campo imagen o categoria es requerida"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/products/get/count": {
            "get": {
                "summary": "Obtiene el total de todos los productos",
                "description": "Cuenta el total de productos registrados",                
                "responses": {
                    "200": {
                        "description": "Devuelve en valor numerico el total de productos",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "integer"                                    
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Error al obtener el total de productos"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/products/get/featured/{count}": {
            "get": {
                "summary": "Obtiene los productos destacados",
                "description": "Retorna los productos destacados teniendo en cuenta el valor del parametros",                
                "parameters": [
                    {
                        "name": "count",
                        "in": "path",
                        "description": "Número de productos a retornar",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Devuelve una lista de los productos destacados",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "$ref": "#/components/schemas/Product"                                    
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Error al obtener los productos destacados"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/products/{id}": {
            "get": {
                "summary": "Obtiene un producto por ID",
                "description": "Retorna un producto por ID",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID del producto a buscar",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Recupera un producto",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Category"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Producto no encontrado"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "summary": "Actualiza un producto por ID",
                "description": "Actualiza un producto almacenado en la base de datos",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID del producto a buscar",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "$ref": "#/components/schemas/NewProduct"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Product response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Product"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Producto no encontrado o actualizado"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "summary": "Borrar un producto por ID",
                "description": "Borra un producto de la base de datos",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID del producto a buscar",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Producto eliminado"
                    },
                    "404": {
                        "description": "Producto no encontrado"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/products/gallery-images/{id}": {
            "put": {
                "summary": "Actualiza el producto con imagenes",
                "description": "Permite subir hasta 10 imagenes y actualizar el producto",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID del producto a buscar",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "images": {
                                        "type": "array",
                                        "items": {
                                            "type": "string",
                                            "format": "binary"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Product response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Product"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Producto no encontrado o actualizado"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            }  
        },
        "/api/v1/orders": {
            "get": {
                "summary": "Get all orders registers",
                "description": "Return all orders from the database",
                "responses": {
                    "200": {
                        "description": "A list of orders",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Order"
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Orders not found"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/users": {
            "get": {
                "summary": "Obtiene todos los usuario",
                "description": "Retorna todos los usuarios de la base de datos",
                "responses": {
                    "200": {
                        "description": "Lista todos los usuarios",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/User"
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Usuario no encontrado"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "summary": "Crea una nuevo usuario",
                "description": "Crea un usuario y lo guarda en la base de datos",
                "operationId": "addCUser",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/NewUser"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/User"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Name, email, password, y phone son campos requeridos"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/users/{id}": {
            "get": {
                "summary": "Obtiene un usuario por ID",
                "description": "Retorn un usuario por ID",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID del usuario a buscar",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Recupera un usuario",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/User"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Usuario no encontrado"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "summary": "Actualiza un usuario por ID",
                "description": "Actualiza un usuario almacenado en la base de datos",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID del usuario a buscar",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/NewUser"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/User"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Name, email, password, y phone son campos requeridos"
                    },
                    "404": {
                        "description": "Usuario no encontrado o actualizado"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "summary": "Borrar un usuario por ID",
                "description": "Borra un usuario de la base de datos",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID del usuario a buscar",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Usuario eliminado"
                    },
                    "404": {
                        "description": "Usuario no encontrado"
                    },
                    "500": {
                        "description": "Error internal server",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "Category": {
                "allOf": [
                    {
                        "$ref": "#/components/schemas/NewCategory"
                    },
                    {
                        "type": "object",
                        "required": [
                            "id"
                        ]
                    }
                ]
            },
            "Product" : {
                "allOf": [
                    {
                        "$ref": "#/components/schemas/NewProduct"
                    }
                ]
            },
            "Order": {
                "allOf": [
                    {
                        "$ref": "#/components/schemas/NewOrder"
                    },
                    {
                        "type": "object",
                        "required": [
                            "id"
                        ]
                    }
                ]
            },
            "User": {
                "allOf": [
                    {
                        "$ref": "#/components/schemas/NewUser"
                    },
                    {
                        "type": "object",
                        "required": [
                            "id"
                        ]
                    }
                ]
            },
            "NewCategory": {
                "type": "object",
                "properties": {                               
                    "name": {
                        "type": "string",
                        "description": "Nombre de la categoria",
                        "example": "mobile"
                    },
                    "icon": {
                        "type": "string",
                        "description": "Icono de la categoria",
                        "example": "mobile" 
                    },
                    "color": {
                        "type": "string",
                        "description": "Color de la categoria en hexadecimal",
                        "example": "#F0E4E1" 
                    }
                }
            },
            "NewProduct": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "Nombre del producto",
                        "example": "Patriot Viper Steel RGB DDR4 RAM 8GB"
                    },
                    "description": {
                        "type": "string",
                        "description": "Descripción del producto",
                        "example": "Módulo DDR4 de 8 GB (1 x 8 GB) 3200 MHz" 
                    },
                    "richDescription": {
                        "type": "string",
                        "description": "Especificaciones del producto",
                        "example": "Probado en las últimas plataformas Intel y AMD para un rendimiento fiable y rápido" 
                    },
                    "image": {
                        "type": "string",
                        "format": "binary",
                        "description": "Imagen principal del producto",
                        "example": "https://m.media-amazon.com/images/I/91ZRYZkh4CL._AC_SX466_.jpg"
                    },
                    "images": {
                        "$ref": "#/components/schemas/Images"
                    },
                    "brand": {
                        "type": "string",
                        "description": "Marca del producto",
                        "example": "Patriot Memory"
                    },
                    "price": {
                        "type": "integer",
                        "description": "Precio del producto",
                        "example": 25.99
                    },
                    "category": {
                        "type": "string",
                        "description": "ID de la categoria",
                        "example": "5f15d54cf3a046427a1c26e3"
                    },
                    "countInStock": {
                        "type": "integer",
                        "nullable": false,
                        "description": "Stock del producto",
                        "minimum": 0,
                        "maximum": 255,
                        "example": 40
                    },
                    "rating": {
                        "type": "integer",
                        "description": "Clasificación del producto, min 0 y max 5",
                        "minimum": 0,
                        "maximum": 5,
                        "example": 3
                    },
                    "numReviews": {
                        "type": "integer",
                        "description": "Numero de vistas",
                        "example": 230
                    },
                    "isFeatured": {
                        "type": "boolean",
                        "description": "Producto destacado",
                        "example": false
                    },
                    "dateCreated": {
                        "type": "date",
                        "description": "Fecha de registro del producto / automático",
                        "example": "2024-02-17T19:28:39.260+00:00"
                    }
                }
            },
            "NewOrder": {
                "type": "object",
                "properties": {
                    "orderItems": {
                        "type": "object",
                        "$ref": ""
                    },
                    "shippingAddress1": {
                        "type": "string",
                        "nullable": false,
                        "description": "",
                        "example": ""
                    },
                    "shippingAddress2": {
                        "type": "string",
                        "nullable": false,
                        "description": "",
                        "example": ""
                    },
                    "city": {
                        "type": "string",
                        "nullable": false,
                        "description": "",
                        "example": ""
                    },
                    "zip": {
                        "type": "string",
                        "nullable": false,
                        "description": "",
                        "example": ""
                    },
                    "country": {
                        "type": "string",
                        "nullable": false,
                        "description": "",
                        "example": ""
                    },
                    "phone": {
                        "type": "string",
                        "nullable": false,
                        "description": "",
                        "example": ""
                    },
                    "status": {
                        "type": "string",
                        "nullable": false,
                        "description": "",
                        "example": ""
                    },
                    "totalPrice": {
                        "type": "integer",
                        "description": "",
                        "example": ""
                    },
                    "user": {
                        "type": "string",
                        "nullable": false,
                        "description": "",
                        "example": ""
                    },
                    "dateOrdered": {
                        "type": "date",
                        "description": "",
                        "example": ""
                    }
                }
            },
            "NewUser": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "Nombre de usuario",
                        "nullable": false,
                        "example": "John Doe"
                    },
                    "email": {
                        "type": "string",
                        "description": "Email del usuario",
                        "nullable": false,
                        "example": "JohnDoe@gmail.com"
                    },
                    "password": {
                        "type": "string",
                        "description": "Contraseña del usuario",
                        "nullable": false,
                        "example": "********"
                    },
                    "phone": {
                        "type": "string",
                        "description": "Número de teléfono",
                        "nullable": false,
                        "example": "+573043625637"
                    },
                    "isAdmin": {
                        "type": "boolean",
                        "description": "Rol de usuario",
                        "example": true
                    },
                    "street": {
                        "type": "string",
                        "description": "Dirección de usuario",
                        "example": "Kra 9 #13A"
                    },
                    "apartment": {
                        "type": "string",
                        "description": "Número de habitación y hotel",
                        "example": "Room 32 hotel StarCity"
                    },
                    "zip": {
                        "type": "string",
                        "description": "Zip de la localidad",
                        "example": "190531"
                    },
                    "city": {
                        "type": "string",
                        "description": "Ciudad de residencia",
                        "example": "New york"
                    },
                    "country": {
                        "type": "string",
                        "description": "Pais de residencia",
                        "example": "Mexico"
                    }
                }
            },
            "Error": {
                "type": "object",
                "required": [
                    "code",
                    "message",
                    "success"
                ],
                "properties": {
                    "code": {
                        "type": "integer",
                        "format": "int32"
                    },
                    "message": {
                        "type": "string"
                    },
                    "success": {
                        "type": "boolean"
                    }
                }
            },
            "Images": {
                "type": "array",
                "properties": {
                    "images": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "format": "binary"
                        }
                    }
                }
            }
        }
    }
}